<!DOCTYPE html>
<html>
  <head>
    <title>CodeQuiz</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= stylesheet_link_tag :app, "data-turbo-track": "reload" %>
    <%= javascript_importmap_tags %>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  </head>

  <body class="bg-[#111827] text-slate-300 min-h-screen flex flex-col">
    <header class="bg-[#1F2937] shadow-lg py-4 mb-8 sticky top-0 z-50"> 
      <nav class="container mx-auto px-6 flex justify-between items-center"> 
        <%= link_to root_path, class: "flex items-center space-x-3 text-2xl font-extrabold text-[#a5b4fc] hover:text-white transition-colors" do %>
          <i class="fas fa-code"></i>
          <span>Code Quiz</span>
        <% end %>
        
        <div class="flex items-center space-x-6">
          <% if user_signed_in? %>
            <div class="relative" data-controller="menu">
              <button class="flex items-center space-x-2 text-slate-300 hover:text-white transition-colors"
                      data-action="click->menu#toggleMenu">
                <div class="w-8 h-8 rounded-full bg-[#4f46e5] flex items-center justify-center">
                  <span class="text-white font-semibold"><%= current_user.email.first.upcase %></span>
                </div>
                <span class="hidden md:inline-block"><%= current_user.email %></span>
              </button>
              
              <div class="absolute right-0 mt-2 w-48 bg-[#1F2937] rounded-lg shadow-lg py-2 hidden z-50"
                   data-menu-target="menu">
                <%= link_to user_profile_path, class: "block px-4 py-2 text-sm text-slate-300 hover:bg-[#4f46e5] hover:text-white transition-colors" do %>
                  <i class="fas fa-user mr-2"></i> Meu Perfil
                <% end %>
                
                <% if current_user.admin? %>
                  <%= link_to users_path, class: "block px-4 py-2 text-sm text-slate-300 hover:bg-[#4f46e5] hover:text-white transition-colors" do %>
                    <i class="fas fa-users-cog mr-2"></i> Gerenciar Usuários
                  <% end %>
                <% end %>
                <%= button_to destroy_user_session_path, method: :delete, class: "w-full text-left px-4 py-2 text-sm text-red-400 hover:bg-red-900 hover:text-red-200 transition-colors" do %>
                  <i class="fas fa-sign-out-alt mr-2"></i> Sair
                <% end %>
              </div>
            </div>
          <% else %>
            <div class="flex items-center space-x-4">
              <%= link_to new_user_session_path, class: "text-slate-300 hover:text-white transition-colors flex items-center" do %>
                <i class="fas fa-sign-in-alt mr-2"></i>
                <span>Entrar</span>
              <% end %>
              <%= link_to new_user_registration_path, class: "bg-[#4f46e5] hover:bg-[#4338ca] text-white font-bold py-2 px-4 rounded transition-colors flex items-center" do %>
                <i class="fas fa-user-plus mr-2"></i>
                <span>Cadastrar</span>
              <% end %>
            </div>
          <% end %>
        </div>
      </nav>
    </header>

    <main class="container mx-auto px-6 flex-grow">
      <% if notice %>
        <div class="bg-emerald-900 border border-emerald-700 text-emerald-200 px-4 py-3 rounded-lg relative mb-6 flex items-center" role="alert">
          <i class="fas fa-check-circle mr-2"></i>
          <%= notice %>
        </div>
      <% end %>
      
      <% if alert %>
        <div class="bg-red-900 border border-red-700 text-red-200 px-4 py-3 rounded-lg relative mb-6 flex items-center" role="alert">
          <i class="fas fa-exclamation-circle mr-2"></i>
          <%= alert %>
        </div>
      <% end %>
      
      <%= yield %>
    </main>

    <footer class="bg-[#1F2937] mt-12 py-6 text-center text-slate-400">
      <div class="container mx-auto px-6">
        <p>© <%= Time.current.year %> Code Quiz </p>
      </div>
    </footer>
  </body>
</html>